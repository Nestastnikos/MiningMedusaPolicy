// autogenerated configuration file
// any manual changes are lost when the file is pregenerated
tree "fs" clone of file by getfile getfile.filename;
primary tree "fs";
tree "domains" of process;

// virtual space definitions
space var_ws = /var;
space usr_ws = /usr;
space var_with_children_rws = recursive /var/tmp
		+ /var/tmp
		+ recursive /var/lib/mysql
		+ recursive /var/log/mariadb;
space etc_with_children_rws = /etc/passwd
		+ /etc/services
		+ /etc/nsswitch.conf
		+ /etc/localtime
		+ /etc/my.cnf.d
		+ /etc/my.cnf
		+ /etc/ld.so.cache
		+ /etc/my.cnf.d/spider.cnf
		+ /etc/my.cnf.d/mysql-clients.cnf
		+ /etc/my.cnf.d/mariadb-server.cnf
		+ /etc/my.cnf.d/cracklib_password_check.cnf
		+ /etc/my.cnf.d/client.cnf
		+ /etc/my.cnf.d/auth_gssapi.cnf;
space dev_with_children_rws = /dev/null
		+ /sys/devices/system/cpu/online;
space lib64_some_rws = /lib64/libnss_sss.so.2
		+ /lib64/libgpg-error.so.0
		+ /lib64/libgcc_s.so.1
		+ /lib64/libgcrypt.so.20
		+ /lib64/libcap.so.2
		+ /lib64/libzstd.so.1
		+ /lib64/libc.so.6
		+ /lib64/libm.so.6
		+ /lib64/libstdc
		+ /lib64/libcrypto.so.1.1
		+ /lib64/libssl.so.1.1
		+ /lib64/libz.so.1
		+ /lib64/libaio.so.1
		+ /lib64/libsystemd.so.0
		+ /lib64/liblzma.so.5
		+ /lib64/liblz4.so.1
		+ /lib64/libcrypt.so.2
		+ /lib64/libpcre2-8.so.0;
space sys_with_children_rws = /sys/block
		+ /sys/block/zram0/dev
		+ /sys/block/zram0/queue/rotational
		+ /proc/sys/crypto/fips_enabled
		+ /sys/block/sda/queue/rotational
		+ /sys/block/dm-0/queue/rotational;
space var_lib_with_children_ws = /var/lib
		+ recursive /var/lib/mysql
		+ /var/lib/mysql;
space run_mariadb_ws = recursive /run/mariadb;
space usr_share_mariadb_charsets_Index.xml_rws = /usr/share/mariadb/charsets/Index.xml;

space mysql = domains/mysql;

mysql	ENTER mysql, READ mysql, WRITE mysql, SEE mysql;


// rule definitions
mysql	READ usr_share_mariadb_charsets_Index.xml_rws, WRITE usr_share_mariadb_charsets_Index.xml_rws, SEE usr_share_mariadb_charsets_Index.xml_rws;
mysql	WRITE run_mariadb_ws, SEE run_mariadb_ws;
mysql	WRITE var_lib_with_children_ws, SEE var_lib_with_children_ws;
mysql	READ sys_with_children_rws, WRITE sys_with_children_rws, SEE sys_with_children_rws;
mysql	READ lib64_some_rws, WRITE lib64_some_rws, SEE lib64_some_rws;
mysql	READ dev_with_children_rws, WRITE dev_with_children_rws, SEE dev_with_children_rws;
mysql	READ etc_with_children_rws, WRITE etc_with_children_rws, SEE etc_with_children_rws;
mysql	READ var_with_children_rws, WRITE var_with_children_rws, SEE var_with_children_rws;
mysql	WRITE usr_ws, SEE usr_ws;
mysql	WRITE var_ws, SEE var_ws;


function init
{}
function constable_init
{}
function enter_domain {
	 enter(process,str2path("domains/"+$1));
}
* getProcess *
{
	if (proctitle.cmdline == "/usr/libexec/mariadbd") {
		enter(process,@"domains/mysql");
	} else {
		enter(process,@"domains/init");
	}
	return OK;
}

